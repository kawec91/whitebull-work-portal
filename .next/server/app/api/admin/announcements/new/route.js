"use strict";(()=>{var e={};e.id=194,e.ids=[194],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},73292:e=>{e.exports=require("fs/promises")},71017:e=>{e.exports=require("path")},84247:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>l,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>g});var n={};a.r(n),a.d(n,{POST:()=>d});var r=a(67092),o=a(25932),i=a(94147),s=a(23187),u=a(6336),p=a(71017),c=a(73292);let d=async e=>{try{let t=await e.formData(),a=t.get("title"),n=t.get("salary"),r=t.get("image")||null,o=t.get("description"),i=Buffer.from(await r.arrayBuffer()),d=`/uploads/annoucements/${new Date(Date.now()).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"-")}`,m=(0,p.join)(process.cwd(),"public",d);try{await (0,c.stat)(m)}catch(e){"ENOENT"===e.code&&await (0,c.mkdir)(m,{recursive:!0}),console.log(e.message)}let l=`${Date.now()}-${Math.round(1e9*Math.random())}`,g=`${r.name.replace(/\.[^/.]+$/,"")}-${l}.${u.Z.getExtension(r.type)}`;await (0,c.writeFile)(`${m}/${g}`,i);let w=`${d}/${g}`,h={title:a,salary:n,image:w,video:"",description:o,location:"ul.Mostowa 36, 87-100 ToruÅ„"};return console.log(h),await s.db.annoucment.create({data:h}),Response.redirect(`${process.env.NEXTAUTH_URL}/admin/announcements`)}catch(e){return console.log("Errors: ",e),new Response(JSON.stringify({message:"error"}),{status:500})}},m=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/announcements/new/route",pathname:"/api/admin/announcements/new",filename:"route",bundlePath:"app/api/admin/announcements/new/route"},resolvedPagePath:"C:\\Users\\lukasz\\Desktop\\Work\\cms\\cmsv0.0.1\\app\\api\\admin\\announcements\\new\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:g,serverHooks:w}=m,h="/api/admin/announcements/new/route";function v(){return(0,i.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:g})}},23187:(e,t,a)=>{a.d(t,{db:()=>n});let n=new(a(53524)).PrismaClient}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[424,315],()=>a(84247));module.exports=n})();